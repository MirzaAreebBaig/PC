[
 {
  "absolute_value": 0,
  "align_labels_right": 0,
  "css": null,
  "custom_format": 1,
  "default_print_language": "en",
  "disabled": 0,
  "doc_type": "SOP",
  "docstatus": 0,
  "doctype": "Print Format",
  "font": null,
  "font_size": 14,
  "format_data": null,
  "html": "<!DOCTYPE html>\r\n<html>\r\n<head>\r\n    <meta charset=\"utf-8\">\r\n    <title>{{ doc.title or \"Document\" }}</title>\r\n    <style>\r\n        @page {\r\n            size: A4;\r\n            margin: 1.5cm;\r\n        }\r\n\r\n        body {\r\n            font-family: Arial, sans-serif;\r\n            font-size: 11pt;\r\n            line-height: 1.4;\r\n            margin: 0;\r\n            padding: 0;\r\n        }\r\n\r\n        /* Header Styles */\r\n        .document-header {\r\n            width: 100%;\r\n            border-collapse: collapse;\r\n            border: 2px solid #000;\r\n            margin-bottom: 15px;\r\n            page-break-after: avoid;\r\n            page-break-inside: avoid;\r\n        }\r\n\r\n        .document-header td, .document-header th {\r\n            border: 1px solid #000;\r\n            padding: 8px;\r\n            vertical-align: middle;\r\n            font-weight: bold;\r\n        }\r\n\r\n        .header-label {\r\n            background-color: #f0f0f0;\r\n            width: 15%;\r\n            text-align: left;\r\n            font-weight: bold;\r\n        }\r\n\r\n        .header-value {\r\n            text-align: left;\r\n            font-weight: normal;\r\n        }\r\n\r\n        .header-row-1 .header-label,\r\n        .header-row-1 .header-value {\r\n            font-size: 12pt;\r\n        }\r\n\r\n        .title-row {\r\n            text-align: center;\r\n            font-weight: bold;\r\n            font-size: 12pt;\r\n            background-color: #f0f0f0;\r\n        }\r\n\r\n        /* Footer Styles */\r\n        .document-footer {\r\n            margin-top: 15px;\r\n            page-break-inside: avoid;\r\n            page-break-before: avoid;\r\n        }\r\n\r\n        .approval-table {\r\n            width: 100%;\r\n            border-collapse: collapse;\r\n            border: 2px solid #000;\r\n        }\r\n\r\n        .approval-table td, .approval-table th {\r\n            border: 1px solid #000;\r\n            padding: 8px;\r\n            vertical-align: top;\r\n        }\r\n\r\n        .approval-header {\r\n            background-color: #f0f0f0;\r\n            text-align: center;\r\n            font-weight: bold;\r\n            font-size: 11pt;\r\n        }\r\n\r\n        .approval-label {\r\n            background-color: #f0f0f0;\r\n            font-weight: bold;\r\n            width: 20%;\r\n        }\r\n\r\n        .approval-content {\r\n            text-align: center;\r\n            width: 26.67%;\r\n        }\r\n\r\n        .signature-cell {\r\n            height: 60px;\r\n            position: relative;\r\n        }\r\n\r\n        .signature-image {\r\n            max-width: 100px;\r\n            max-height: 50px;\r\n            display: block;\r\n            margin: 0 auto;\r\n        }\r\n\r\n        .signature-date {\r\n            font-size: 9pt;\r\n            margin-top: 5px;\r\n        }\r\n\r\n        .format-info {\r\n            margin-top: 10px;\r\n            font-size: 9pt;\r\n            color: #666;\r\n            text-align: center;\r\n        }\r\n\r\n        /* Body Content Styles */\r\n        .document-body {\r\n            min-height: 400px;\r\n            margin: 20px 0;\r\n        }\r\n\r\n        .document-body h1, .document-body h2, .document-body h3 {\r\n            margin-top: 20px;\r\n            margin-bottom: 10px;\r\n            page-break-after: avoid;\r\n        }\r\n\r\n        .document-body p {\r\n            margin-bottom: 10px;\r\n            text-align: justify;\r\n            orphans: 3;\r\n            widows: 3;\r\n        }\r\n\r\n        .document-body ul, .document-body ol {\r\n            margin-bottom: 10px;\r\n            padding-left: 25px;\r\n        }\r\n\r\n        /* Page Break Control */\r\n        .page-section {\r\n            page-break-after: always;\r\n            page-break-inside: avoid;\r\n            min-height: 95vh;\r\n            max-height: 95vh;\r\n            display: flex;\r\n            flex-direction: column;\r\n            box-sizing: border-box;\r\n            padding: 0;\r\n            margin: 0;\r\n        }\r\n\r\n        .page-section:last-child {\r\n            page-break-after: auto;\r\n        }\r\n\r\n        .content-chunk {\r\n            flex: 1;\r\n            padding: 10px 0;\r\n            overflow: hidden;\r\n            box-sizing: border-box;\r\n        }\r\n\r\n        /* Print Styles */\r\n        @media print {\r\n            @page {\r\n                size: A4;\r\n                margin: 1cm;\r\n            }\r\n            \r\n            body {\r\n                -webkit-print-color-adjust: exact;\r\n                print-color-adjust: exact;\r\n                margin: 0;\r\n                padding: 0;\r\n            }\r\n            \r\n            .page-section {\r\n                min-height: 26.7cm; /* A4 height minus margins */\r\n                max-height: 26.7cm;\r\n                page-break-after: always;\r\n                page-break-inside: avoid;\r\n                display: flex;\r\n                flex-direction: column;\r\n                justify-content: space-between;\r\n                margin: 0;\r\n                padding: 0.5cm;\r\n                box-sizing: border-box;\r\n            }\r\n            \r\n            .page-section:last-child {\r\n                page-break-after: auto;\r\n            }\r\n            \r\n            .document-header {\r\n                page-break-after: avoid;\r\n                page-break-inside: avoid;\r\n                flex-shrink: 0;\r\n            }\r\n            \r\n            .document-footer {\r\n                page-break-before: avoid;\r\n                page-break-inside: avoid;\r\n                flex-shrink: 0;\r\n                margin-top: auto;\r\n            }\r\n            \r\n            .content-chunk {\r\n                flex: 1;\r\n                overflow: hidden;\r\n                page-break-inside: auto;\r\n            }\r\n        }\r\n\r\n        /* Utility classes for content flow */\r\n        .avoid-break {\r\n            page-break-inside: avoid;\r\n        }\r\n\r\n        .break-before {\r\n            page-break-before: always;\r\n        }\r\n\r\n        .break-after {\r\n            page-break-after: always;\r\n        }\r\n    </style>\r\n</head>\r\n<body>\r\n    <div id=\"document-container\"></div>\r\n\r\n    <script>\r\n        // Document data - in real Frappe, this would come from the template variables\r\n        const docData = {\r\n            subject: \"{{ doc.subject or '' }}\",\r\n            document_no: \"{{ doc.document_no or '' }}\",\r\n            effective_date: \"{% if doc.approved_datetime %}{{ frappe.utils.formatdate(doc.approved_datetime, 'dd/mm/yyyy') }}{% endif %}\",\r\n            supersedes: \"{{ doc.supersedes or 'NIL' }}\",\r\n            review_date: \"{% if doc.reviewed_datetime %}{{ frappe.utils.formatdate(doc.reviewed_datetime, 'dd/mm/yyyy') }}{% endif %}\",\r\n            department: \"{{ doc.department or '' }}\",\r\n            title: \"{{ doc.title or '' }}\",\r\n            content: `{% if doc.document_content %}{{ doc.document_content | safe }}{% endif %}`,\r\n            prepared_by_name: \"{{ doc.prepared_by_name or '' }}\",\r\n            reviewed_by_name: \"{{ doc.reviewed_by_name or '' }}\",\r\n            approved_by_name: \"{{ doc.approved_by_name or '' }}\",\r\n            prepared_by_designation: \"{{ doc.prepared_by_designation or '' }}\",\r\n            reviewed_by_designation: \"{{ doc.reviewed_by_designation or '' }}\",\r\n            approved_by_designation: \"{{ doc.approved_by_designation or '' }}\",\r\n            prepared_sign: \"{% if doc.prepared_sign %}{{ doc.prepared_sign }}{% endif %}\",\r\n            reviewed_sign: \"{% if doc.reviewed_sign %}{{ doc.reviewed_sign }}{% endif %}\",\r\n            approved_sign: \"{% if doc.approved_sign %}{{ doc.approved_sign }}{% endif %}\",\r\n            prepared_datetime: \"{% if doc.prepared_datetime %}{{ frappe.utils.format_datetime(doc.prepared_datetime, 'dd/mm/yyyy') }}{% endif %}\",\r\n            reviewed_datetime: \"{% if doc.reviewed_datetime %}{{ frappe.utils.format_datetime(doc.reviewed_datetime, 'dd/mm/yyyy') }}{% endif %}\",\r\n            approved_datetime: \"{% if doc.approved_datetime %}{{ frappe.utils.format_datetime(doc.approved_datetime, 'dd/mm/yyyy') }}{% endif %}\"\r\n        };\r\n\r\n        function createHeader(pageNum, totalPages) {\r\n            return `\r\n                <table class=\"document-header\">\r\n                    <tr class=\"header-row-1\">\r\n                        <td class=\"header-label\">SUBJECT</td>\r\n                        <td class=\"header-value\" colspan=\"3\">${docData.subject}</td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td class=\"header-label\">SOP NO.</td>\r\n                        <td class=\"header-value\">${docData.document_no}</td>\r\n                        <td class=\"header-label\">EFFECTIVE DATE</td>\r\n                        <td class=\"header-value\">${docData.effective_date}</td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td class=\"header-label\">SUPERSEDES</td>\r\n                        <td class=\"header-value\">${docData.supersedes}</td>\r\n                        <td class=\"header-label\">REVIEW DATE</td>\r\n                        <td class=\"header-value\">${docData.review_date}</td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td class=\"header-label\">DEPARTMENT</td>\r\n                        <td class=\"header-value\">${docData.department}</td>\r\n                        <td class=\"header-label\">PAGE No.</td>\r\n                        <td class=\"header-value\">${pageNum} of ${totalPages}</td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td class=\"title-row\" colspan=\"4\">\r\n                            <strong>TITLE: ${docData.title}</strong>\r\n                        </td>\r\n                    </tr>\r\n                </table>\r\n            `;\r\n        }\r\n\r\n        function createFooter() {\r\n            return `\r\n                <div class=\"document-footer\">\r\n                    <table class=\"approval-table\">\r\n                        <tr>\r\n                            <td class=\"approval-label\"></td>\r\n                            <td class=\"approval-header\">PREPARED BY</td>\r\n                            <td class=\"approval-header\">REVIEWED BY</td>\r\n                            <td class=\"approval-header\">APPROVED BY</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class=\"approval-label\">Name</td>\r\n                            <td class=\"approval-content\">${docData.prepared_by_name}</td>\r\n                            <td class=\"approval-content\">${docData.reviewed_by_name}</td>\r\n                            <td class=\"approval-content\">${docData.approved_by_name}</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class=\"approval-label\">Designation / Dept.</td>\r\n                            <td class=\"approval-content\">${docData.prepared_by_designation}</td>\r\n                            <td class=\"approval-content\">${docData.reviewed_by_designation}</td>\r\n                            <td class=\"approval-content\">${docData.approved_by_designation}</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td class=\"approval-label\">Signature & Date</td>\r\n                            <td class=\"approval-content signature-cell\">\r\n                                ${docData.prepared_sign ? `<img src=\"${docData.prepared_sign}\" alt=\"Prepared Signature\" class=\"signature-image\">` : ''}\r\n                                ${docData.prepared_datetime ? `<div class=\"signature-date\">${docData.prepared_datetime}</div>` : ''}\r\n                            </td>\r\n                            <td class=\"approval-content signature-cell\">\r\n                                ${docData.reviewed_sign ? `<img src=\"${docData.reviewed_sign}\" alt=\"Reviewed Signature\" class=\"signature-image\">` : ''}\r\n                                ${docData.reviewed_datetime ? `<div class=\"signature-date\">${docData.reviewed_datetime}</div>` : ''}\r\n                            </td>\r\n                            <td class=\"approval-content signature-cell\">\r\n                                ${docData.approved_sign ? `<img src=\"${docData.approved_sign}\" alt=\"Approved Signature\" class=\"signature-image\">` : ''}\r\n                                ${docData.approved_datetime ? `<div class=\"signature-date\">${docData.approved_datetime}</div>` : ''}\r\n                            </td>\r\n                        </tr>\r\n                    </table>\r\n                    <div class=\"format-info\">\r\n                        Format No.: QA002-F01-00\r\n                    </div>\r\n                </div>\r\n            `;\r\n        }\r\n\r\n        function splitContentIntoChunks(content, maxChunkSize = 800) {\r\n            if (!content) return [''];\r\n            \r\n            // Create a temporary div to measure content\r\n            const tempDiv = document.createElement('div');\r\n            tempDiv.style.cssText = `\r\n                position: absolute;\r\n                visibility: hidden;\r\n                width: 18cm;\r\n                font-family: Arial, sans-serif;\r\n                font-size: 11pt;\r\n                line-height: 1.4;\r\n                padding: 0;\r\n                margin: 0;\r\n            `;\r\n            document.body.appendChild(tempDiv);\r\n            \r\n            // Split content into smaller pieces\r\n            const elements = content.split(/(<\\/(?:p|div|h[1-6]|li|ul|ol)>)/i);\r\n            const chunks = [];\r\n            let currentChunk = '';\r\n            \r\n            for (let i = 0; i < elements.length; i += 2) {\r\n                const element = elements[i] + (elements[i + 1] || '');\r\n                \r\n                // Test if adding this element would exceed the chunk size\r\n                tempDiv.innerHTML = currentChunk + element;\r\n                const estimatedHeight = tempDiv.offsetHeight;\r\n                \r\n                // If content is getting too long (roughly 15cm of content area)\r\n                if (estimatedHeight > 400 && currentChunk) {\r\n                    chunks.push(currentChunk);\r\n                    currentChunk = element;\r\n                } else {\r\n                    currentChunk += element;\r\n                }\r\n            }\r\n            \r\n            if (currentChunk) {\r\n                chunks.push(currentChunk);\r\n            }\r\n            \r\n            document.body.removeChild(tempDiv);\r\n            return chunks.length > 0 ? chunks : [content];\r\n        }\r\n\r\n        function generateDocument() {\r\n            const container = document.getElementById('document-container');\r\n            const contentChunks = splitContentIntoChunks(docData.content);\r\n            const totalPages = contentChunks.length;\r\n            \r\n            let documentHTML = '';\r\n            \r\n            contentChunks.forEach((chunk, index) => {\r\n                const pageNum = index + 1;\r\n                const isLastPage = index === contentChunks.length - 1;\r\n                \r\n                documentHTML += `\r\n                    <div class=\"page-section\">\r\n                        <div style=\"flex-shrink: 0;\">\r\n                            ${createHeader(pageNum, totalPages)}\r\n                        </div>\r\n                        <div class=\"document-body content-chunk\">\r\n                            ${chunk}\r\n                        </div>\r\n                        <div style=\"flex-shrink: 0; margin-top: auto;\">\r\n                            ${createFooter()}\r\n                        </div>\r\n                    </div>\r\n                `;\r\n            });\r\n            \r\n            container.innerHTML = documentHTML;\r\n        }\r\n\r\n        // Generate the document when page loads\r\n        window.addEventListener('load', generateDocument);\r\n\r\n        // Regenerate on print to ensure proper formatting\r\n        window.addEventListener('beforeprint', function() {\r\n            generateDocument();\r\n        });\r\n    </script>\r\n</body>\r\n</html>",
  "line_breaks": 0,
  "margin_bottom": 15.0,
  "margin_left": 15.0,
  "margin_right": 15.0,
  "margin_top": 15.0,
  "modified": "2025-07-03 19:55:46.360350",
  "module": "Pharma Compliance",
  "name": "Document Print",
  "page_number": "Hide",
  "pdf_generator": "wkhtmltopdf",
  "print_format_builder": 0,
  "print_format_builder_beta": 0,
  "print_format_type": "Jinja",
  "raw_commands": null,
  "raw_printing": 0,
  "show_section_headings": 0,
  "standard": "No"
 }
]